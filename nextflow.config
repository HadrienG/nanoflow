manifest {
    mainScript = 'main.nf'
}

profiles {
    standard {
        executor = 'local'
        docker.enabled = true

        process {
        	$adapter_trimming {
        		container = "hadrieng/porechop"
        		cpus = params.cpus
        		memory = '8 GB'
        	}
            $assembly {

                if (params.assembler == 'miniasm') {
                    container = 'hadrieng/miniasm'
                }
                else if (params.assembler == 'unicycler') {
                    container = 'hadrieng/unicycler'
                }
                else {
                    container = 'hadrieng/canu'
                }
                cpus = params.cpus
                memory = '8GB'
            }
            $consensus {
                container = "hadrieng/racon"
                cpu = params.cpus
                memory = '8GB'
            }
            $polishing {
                container = "hadrieng/nanopolish"
                cpu = params.cpus
                memory = '8GB'
            }
        }
    }

    planet {
        executor = 'sge'
        docker.enabled = false

        process {
            $adapter_trimming {
                clusterOptions = '-S /bin/bash -l h_vmem=1G'
                time = '24h'
                penv = 'smp'
                cpus = 8
                module = 'porechop'
            }
            $assembly {
                if (params.assembler == 'miniasm') {
                    clusterOptions = '-S /bin/bash -l h_vmem=5G'
                    time = '24h'
                    penv = 'smp'
                    cpus = 8
                    module = 'miniasm'
                }
                else if (params.assembler == 'unicycler') {
                    clusterOptions = '-S /bin/bash -l h_vmem=5G'
                    time = '24h'
                    penv = 'smp'
                    cpus = 8
                    module = 'unicycler'
                }
                else {
                    clusterOptions = '-S /bin/bash -l h_vmem=5G'
                    time = '240h'
                    penv = 'smp'
                    cpus = 8
                    module = 'canu'
                }
            }
            $consensus {
                clusterOptions = '-S /bin/bash -l h_vmem=1G'
                time = '24h'
                penv = 'smp'
                cpus = 8
                module = 'racon'
            }
            $polishing {
                clusterOptions = '-S /bin/bash -l h_vmem=1G'
                time = '240h'
                penv = 'smp'
                cpus = 8
                module = 'nanopolish'
            }
        }
    }
}
